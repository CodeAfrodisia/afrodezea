import{d as w,r as o,j as s,L as j,s as _}from"./index-Cfo4WONF.js";import{P as v}from"./ProductsGrid-BKAsmNLG.js";import"./productsSupabase-fJvJppfC.js";function b(){const{ids:t=[],loading:m}=w(),[c,n]=o.useState([]),[g,d]=o.useState(!1);o.useEffect(()=>{let i=!0;async function e(r){const l=r==="slug"?"id, title, slug, image_url, price_cents":"id, title, handle, image_url, price_cents",{data:y,error:u}=await _.from("products").select(l).in("id",t);if(u)throw u;const x=new Map((y||[]).map(a=>[a.id,a]));return t.map(a=>x.get(a)).filter(Boolean).map(a=>({...a,handle:a.slug??a.handle??null}))}async function f(){if(!t||t.length===0){i&&n([]);return}d(!0);try{const r=await e("slug");i&&n(r)}catch(r){if(r?.code==="42703")try{const l=await e("handle");i&&n(l)}catch(l){console.error("[wishlist] load products failed (handle retry):",l),i&&n([])}else console.error("[wishlist] load products failed:",r),i&&n([])}finally{i&&d(!1)}}return f(),()=>{i=!1}},[t]);const h=o.useMemo(()=>(Array.isArray(c)?c:[]).map(e=>({id:e.id,title:e.title,handle:e.handle,image_url:e.image_url||null,price_cents:e.price_cents??0,priceRange:{minVariantPrice:{amount:(e.price_cents??0)/100,currencyCode:"USD"}},images:e.image_url?{nodes:[{url:e.image_url}]}:{nodes:[]}})),[c]),p=!t||t.length===0;return s.jsxs("div",{className:"container",style:{padding:24},children:[s.jsx("h1",{className:"display",style:{marginBottom:12},children:"Your Wishlist"}),p?s.jsxs("div",{className:"surface",style:{padding:16},children:[s.jsx("p",{className:"lead",style:{marginTop:0},children:"No items yet."}),s.jsx(j,{className:"btn btn--gold",to:"/products",children:"Browse products"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{marginBottom:12,display:"flex",gap:8,alignItems:"center"},children:s.jsxs("span",{style:{opacity:.85},children:[t.length," saved ",t.length===1?"item":"items",m||g?" • loading…":""]})}),s.jsx(v,{products:h,onQuickView:()=>{}}),s.jsx("div",{style:{marginTop:16,opacity:.8},children:"Tip: open a product and tap ♥ to remove it from your wishlist."})]})]})}export{b as default};
