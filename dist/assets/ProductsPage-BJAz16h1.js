const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QuickViewModal-Nw3fXHAc.js","assets/index-Cfo4WONF.js","assets/index-BirdHXlw.css","assets/NotesRadar-CQK1XroP.js","assets/profileHeuristics-B2N-M0O0.js","assets/ProductsGrid-BKAsmNLG.js","assets/productsSupabase-fJvJppfC.js","assets/ratings-Bx631r91.js"])))=>i.map(i=>d[i]);
import{j as e,r as l,u as be,_ as de,H as je,g as ve,R as ue}from"./index-Cfo4WONF.js";import{s as Se}from"./productsSupabase-fJvJppfC.js";import{t as le,P as Ce}from"./ProductsGrid-BKAsmNLG.js";function we({tabs:r,active:p,onChange:y}){return e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map(f=>{const n=f.key===p;return e.jsx("button",{onClick:()=>y(f.key),style:{padding:"10px 14px",textAlign:"left",borderRadius:10,border:`1px solid ${n?"#6a5":"#333"}`,background:n?"#1a1f16":"#121212",color:"#eee",cursor:"pointer"},children:f.label},f.key)})})}function ke({query:r,onQueryChange:p,selectedTags:y,onToggleTag:f,minPrice:n,maxPrice:j,onPriceChange:M,order:A,onOrderChange:E,tagsCatalog:S}){const I=l.useMemo(()=>S&&S.length?S:["floral","fruity","citrus","fresh","woody","spicy","sweet","smoky"],[S]),q=Array.isArray(y)&&typeof f=="function",N=typeof M=="function"&&(n===null||typeof n=="number")&&(j===null||typeof j=="number"),L=typeof E=="function"&&typeof A=="string";return e.jsxs("div",{className:"surface",style:{padding:16,borderRadius:16,display:"grid",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-search",style:{display:"block",marginBottom:8,color:"var(--text-muted)"},children:"Search"}),e.jsx("input",{id:"filter-search",className:"input",type:"search",value:r,placeholder:"Search candles…",onChange:a=>{p(a.target.value),le("search_change",{q:a.target.value})}})]}),q&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("label",{style:{color:"var(--text-muted)"},children:"Scent notes"}),e.jsx("button",{type:"button",className:"btn btn--ghost",style:{padding:"2px 8px",fontSize:12},onClick:()=>y.forEach(a=>f(a)),"aria-label":"Clear selected tags",title:"Clear selected",children:"Clear"})]}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:I.map(a=>{const C=y.includes(a);return e.jsx("button",{type:"button",onClick:()=>{f(a)},className:`chip ${C?"active":""}`,"aria-pressed":C,style:{padding:"6px 10px",borderRadius:999,border:"1px solid var(--hairline)",background:C?"rgba(212,175,55,.12)":"transparent"},children:a.charAt(0).toUpperCase()+a.slice(1)},a)})})]}),N&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:8,color:"var(--text-muted)"},children:"Price range ($)"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx(re,{placeholder:"Min",value:n??"",onChange:a=>{M(a===""?null:ae(a),j)}}),e.jsx("span",{style:{opacity:.6},children:"—"}),e.jsx(re,{placeholder:"Max",value:j??"",onChange:a=>{M(n,a===""?null:ae(a))}})]})]}),L&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-order",style:{display:"block",marginBottom:8,color:"var(--text-muted)"},children:"Sort by"}),e.jsxs("select",{id:"filter-order",className:"input",value:A,onChange:a=>{E(a.target.value),le("sort_change",{order:a.target.value})},children:[e.jsx("option",{value:"new",children:"Newest"}),e.jsx("option",{value:"price_asc",children:"Price: Low → High"}),e.jsx("option",{value:"price_desc",children:"Price: High → Low"})]})]})]})}function ae(r){const p=Number(r);return Number.isFinite(p)?p:0}function re({value:r,onChange:p,placeholder:y}){return e.jsx("input",{className:"input",inputMode:"numeric",pattern:"[0-9]*",placeholder:y,style:{width:100},value:r,onChange:f=>p(f.target.value.replace(/[^\d.]/g,""))})}const _e=ue.lazy(()=>de(()=>import("./QuickViewModal-Nw3fXHAc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Me=[{key:"all",label:"All Collections"},{key:"affirmation",label:"Affirmation"},{key:"afrodisia",label:"Afrodisia"},{key:"pantheon",label:"Pantheon"},{key:"fall",label:"Fall"},{key:"winter",label:"Winter"}],ie="https://afrodezea.com",oe=r=>r?r.split(",").map(p=>p.trim()).filter(Boolean):[],ce=r=>r&&r.length?r.join(","):"";function _({children:r,onClick:p}){return e.jsx("button",{type:"button",onClick:p,className:"chip",style:{padding:"6px 10px",borderRadius:999,border:"1px solid var(--hairline)",background:"rgba(212,175,55,.10)",color:"inherit",cursor:"pointer"},children:r})}function Ee(){const r=ve(),p="Luxury Candles | Afrodezea",y="Explore premium candles with rich scent profiles. Filter by notes and intensity.",f=`${ie}/products`,[n,j]=be(),M=(n.get("collection")||"all").toLowerCase(),A=n.get("q")||"",E=oe(n.get("tags")).map(t=>t.toLowerCase()),S=n.get("min")?Number(n.get("min")):null,I=n.get("max")?Number(n.get("max")):null,q=n.get("order")||"new",[N,L]=l.useState(!0),[a,C]=l.useState([]),[W,D]=l.useState(0),[c,P]=l.useState(M),[m,T]=l.useState(A),[x,H]=l.useState(E),[d,G]=l.useState(S),[u,U]=l.useState(I),[g,V]=l.useState(q),[$,i]=l.useState(1),[pe,J]=l.useState(!1),[K,ge]=l.useState(null),[X,Y]=l.useState(""),[he,me]=l.useState([]);l.useEffect(()=>{let t=!0;return(async()=>{try{const s=(await de(async()=>{const{default:b}=await import("./index-Cfo4WONF.js").then(k=>k.v);return{default:b}},__vite__mapDeps([1,2]))).default,{data:h,error:o}=await s.from("products_tags_catalog").select("tag").order("tag",{ascending:!0});!o&&t&&me((h||[]).map(b=>String(b.tag).toLowerCase()))}catch{}})(),()=>{t=!1}},[]),l.useEffect(()=>{const t=setTimeout(()=>{const s=new URLSearchParams(n);c&&c!=="all"?s.set("collection",c):s.delete("collection"),m.trim()?s.set("q",m.trim()):s.delete("q"),x.length?s.set("tags",ce(x)):s.delete("tags"),d!=null?s.set("min",String(d)):s.delete("min"),u!=null?s.set("max",String(u)):s.delete("max"),g&&g!=="new"?s.set("order",g):s.delete("order"),s.delete("page"),s.toString()!==n.toString()&&j(s,{replace:!1})},100);return()=>clearTimeout(t)},[c,m,x,d,u,g,n,j]),l.useEffect(()=>{const t=(n.get("collection")||"all").toLowerCase(),s=n.get("q")||"",h=oe(n.get("tags")).map(v=>v.toLowerCase()),o=n.get("min")?Number(n.get("min")):null,b=n.get("max")?Number(n.get("max")):null,k=n.get("order")||"new";P(v=>v!==t?t:v),T(v=>v!==s?s:v),h.join("|")!==x.join("|")&&H(h),o!==d&&G(o),b!==u&&U(b),k!==g&&V(k)},[n.toString()]);const z=l.useMemo(()=>{const t=new URLSearchParams;c&&c!=="all"&&t.set("collection",c),m.trim()&&t.set("q",m.trim()),x.length&&t.set("tags",ce(x)),d!=null&&t.set("min",String(d)),u!=null&&t.set("max",String(u)),g&&g!=="new"&&t.set("order",g);const s=t.toString();return s?`?${s}`:""},[c,m,x,d,u,g]);l.useEffect(()=>{try{sessionStorage.setItem("afd:lastProductsSearch",z||"")}catch{}},[z]);const Z=t=>{const s=t.toLowerCase();H(h=>{const o=new Set(h);return o.has(s)?o.delete(s):o.add(s),Array.from(o)}),i(1)},O=(t,s)=>{G(t??null),U(s??null),i(1)},B=t=>{V(t),i(1)};l.useEffect(()=>{let t=!0;L(!0),Y("");const s=setTimeout(async()=>{try{const{rows:h,total:o}=await Se({q:m,collection:c,tags:x,minPriceCents:typeof d=="number"?d:void 0,maxPriceCents:typeof u=="number"?u:void 0,order:g,page:1,pageSize:120});t&&(C(h),D(o),i(1))}catch(h){t&&(Y(h?.message||"Could not load products."),C([]),D(0))}finally{t&&L(!1)}},160);return()=>{t=!1,clearTimeout(s)}},[m,c,x.join("|"),d,u,g]),l.useRef(null);const[R,fe]=l.useState(4),ee=24,te=300,se=l.useRef(null);l.useEffect(()=>{const t=se.current;if(!t||typeof ResizeObserver>"u")return;const s=o=>{const b=o??t.clientWidth??0,k=Math.max(1,Math.floor((b+ee)/(te+ee)));fe(k)},h=new ResizeObserver(([o])=>s(o?.contentRect?.width));return h.observe(t),s(),()=>h.disconnect()},[]);const F=2*Math.max(1,R),w=Math.max(1,Math.ceil((a?.length||0)/F));l.useLayoutEffect(()=>{i(t=>Math.min(Math.max(t,1),w))},[w]);const ne=($-1)*F,Q=(a||[]).slice(ne,ne+F),xe=72,ye=280;return l.useEffect(()=>{console.log({columns:R,perSlide:2*R,visible:Q.length})},[R,Q.length]),e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsx("title",{children:p}),e.jsx("meta",{name:"description",content:y}),e.jsx("link",{rel:"canonical",href:`${r}/products`}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:title",content:p}),e.jsx("meta",{property:"og:description",content:y}),e.jsx("meta",{property:"og:url",content:f}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"})]}),!N&&a?.length>0&&e.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"ItemList",itemListElement:a.map((t,s)=>({"@type":"ListItem",position:s+1,url:`${ie}/p/${t.handle||t.slug}`,name:t.title}))})}),e.jsx(ue.Suspense,{fallback:null,children:e.jsx(_e,{open:pe,onClose:()=>J(!1),product:K},K?.id||"empty")}),e.jsxs("div",{className:"container",style:{padding:24,height:`calc(100vh - ${xe}px)`,display:"grid",gridTemplateColumns:`${ye}px 1fr`,gridTemplateRows:"auto 1fr",gridTemplateAreas:'"header header" "aside main"',gap:24},children:[e.jsxs("div",{style:{gridArea:"header",opacity:.85},children:[N?"Loading…":`${W} result${W===1?"":"s"}`,m?` for “${m}”`:"",c!=="all"?` in ${c}`:""]}),e.jsxs("aside",{style:{gridArea:"aside",position:"sticky",top:84,alignSelf:"start",maxHeight:"100%",overflow:"auto"},children:[e.jsx("div",{className:"surface",style:{padding:12},children:e.jsx(we,{tabs:Me,active:c,onChange:t=>{P(t),i(1)}})}),e.jsx("div",{style:{height:12}}),e.jsx("div",{className:"surface",style:{padding:12},children:e.jsx(ke,{query:m,onQueryChange:t=>{T(t),i(1)},selectedTags:x,onToggleTag:t=>{Z(t)},tagsCatalog:he,minPrice:d!=null?Math.round(d/100):null,maxPrice:u!=null?Math.round(u/100):null,onPriceChange:(t,s)=>{const h=t==null?null:Math.round(Number(t)*100),o=s==null?null:Math.round(Number(s)*100);O(h,o)},order:g,onOrderChange:t=>{B(t)}})})]}),e.jsx("main",{style:{gridArea:"main",height:"100%",minHeight:0,display:"flex",flexDirection:"column"},children:e.jsx("div",{style:{position:"relative",flex:"1 1 auto"},children:N?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:20},children:Array.from({length:8}).map((t,s)=>e.jsx("div",{style:{height:320,borderRadius:16,background:"linear-gradient(90deg,#151515,#1a1a1a,#151515)",animation:"shimmer 1.2s linear infinite",backgroundSize:"300% 100%"}},s))}):e.jsxs(e.Fragment,{children:[(x.length||d!=null||u!=null||g!=="new"||m||c!=="all")&&e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:[c!=="all"&&e.jsxs(_,{onClick:()=>{P("all"),i(1)},children:["Collection: ",c," ×"]}),m&&e.jsxs(_,{onClick:()=>{T(""),i(1)},children:["Search: “",m,"” ×"]}),x.map(t=>e.jsxs(_,{onClick:()=>{Z(t),i(1)},children:[t," ×"]},t)),d!=null&&e.jsxs(_,{onClick:()=>{O(null,u),i(1)},children:["Min $",Math.round(d/100)," ×"]}),u!=null&&e.jsxs(_,{onClick:()=>{O(d,null),i(1)},children:["Max $",Math.round(u/100)," ×"]}),g!=="new"&&e.jsxs(_,{onClick:()=>{B("new"),i(1)},children:["Sort ",g.replace("_"," ")," ×"]}),e.jsx("button",{className:"btn btn--ghost",onClick:()=>{P("all"),T(""),H([]),O(null,null),B("new"),i(1)},children:"Clear all"})]}),X&&e.jsxs("div",{className:"surface",style:{padding:12,marginBottom:12,border:"1px solid var(--hairline)"},children:[e.jsx("strong",{children:"Heads up:"})," ",X]}),e.jsx("div",{ref:se,style:{width:"100%"},children:e.jsx(Ce,{products:Q,fromSearch:z,onQuickView:t=>{ge(t),J(!0)},columns:R,cardMin:te})}),w>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,marginTop:16},children:[e.jsx("button",{className:"btn btn--ghost",onClick:()=>i(t=>Math.max(1,t-1)),disabled:$<=1,children:"← Prev"}),e.jsx("div",{style:{display:"flex",gap:6},children:Array.from({length:w}).map((t,s)=>e.jsx("button",{"aria-label":`Go to page ${s+1}`,onClick:()=>i(s+1),style:{width:8,height:8,borderRadius:9999,opacity:s+1===$?1:.35,background:"var(--c-gold, #f4c86a)",border:"none"}},s))}),e.jsx("button",{className:"btn btn--ghost",onClick:()=>i(t=>Math.min(w,t+1)),disabled:$>=w,children:"Next →"})]})]})})})]})]})}export{Ee as default};
