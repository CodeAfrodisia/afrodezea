const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QuickViewModal-D5f2Mn55.js","assets/index-Du-y3j9l.js","assets/index-CPw1xV8w.css","assets/NotesRadar-DQQsafu8.js","assets/profileHeuristics-B2N-M0O0.js"])))=>i.map(i=>d[i]);
import{R as e,r as s,u as oe,H as ie,g as ce,_ as ue}from"./index-Du-y3j9l.js";import{s as me}from"./productsSupabase-C9KWaEbR.js";import{t as J,P as de}from"./ProductsGrid-rX90Bkru.js";function pe({tabs:o,active:i,onChange:y}){return e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:8}},o.map(u=>{const a=u.key===i;return e.createElement("button",{key:u.key,onClick:()=>y(u.key),style:{padding:"10px 14px",textAlign:"left",borderRadius:10,border:`1px solid ${a?"#6a5":"#333"}`,background:a?"#1a1f16":"#121212",color:"#eee",cursor:"pointer"}},u.label)}))}function ge({query:o,onQueryChange:i,selectedTags:y,onToggleTag:u,minPrice:a,maxPrice:b,onPriceChange:C,order:N,onOrderChange:M,tagsCatalog:k}){const P=s.useMemo(()=>k&&k.length?k:["floral","fruity","citrus","fresh","woody","spicy","sweet","smoky"],[k]),L=Array.isArray(y)&&typeof u=="function",_=typeof C=="function"&&(a===null||typeof a=="number")&&(b===null||typeof b=="number"),w=typeof M=="function"&&typeof N=="string";return e.createElement("div",{className:"surface",style:{padding:16,borderRadius:16,display:"grid",gap:12}},e.createElement("div",null,e.createElement("label",{htmlFor:"filter-search",style:{display:"block",marginBottom:8,color:"var(--text-muted)"}},"Search"),e.createElement("input",{id:"filter-search",className:"input",type:"search",value:o,placeholder:"Search candles…",onChange:l=>{i(l.target.value),J("search_change",{q:l.target.value})}})),L&&e.createElement("div",null,e.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8}},e.createElement("label",{style:{color:"var(--text-muted)"}},"Scent notes"),e.createElement("button",{type:"button",className:"btn btn--ghost",style:{padding:"2px 8px",fontSize:12},onClick:()=>y.forEach(l=>u(l)),"aria-label":"Clear selected tags",title:"Clear selected"},"Clear")),e.createElement("div",{style:{display:"flex",gap:8,flexWrap:"wrap"}},P.map(l=>{const x=y.includes(l);return e.createElement("button",{key:l,type:"button",onClick:()=>{u(l)},className:`chip ${x?"active":""}`,"aria-pressed":x,style:{padding:"6px 10px",borderRadius:999,border:"1px solid var(--hairline)",background:x?"rgba(212,175,55,.12)":"transparent"}},l.charAt(0).toUpperCase()+l.slice(1))}))),_&&e.createElement("div",null,e.createElement("label",{style:{display:"block",marginBottom:8,color:"var(--text-muted)"}},"Price range ($)"),e.createElement("div",{style:{display:"flex",gap:8,alignItems:"center"}},e.createElement(K,{placeholder:"Min",value:a??"",onChange:l=>{C(l===""?null:D(l),b)}}),e.createElement("span",{style:{opacity:.6}},"—"),e.createElement(K,{placeholder:"Max",value:b??"",onChange:l=>{C(a,l===""?null:D(l))}}))),w&&e.createElement("div",null,e.createElement("label",{htmlFor:"filter-order",style:{display:"block",marginBottom:8,color:"var(--text-muted)"}},"Sort by"),e.createElement("select",{id:"filter-order",className:"input",value:N,onChange:l=>{M(l.target.value),J("sort_change",{order:l.target.value})}},e.createElement("option",{value:"new"},"Newest"),e.createElement("option",{value:"price_asc"},"Price: Low → High"),e.createElement("option",{value:"price_desc"},"Price: High → Low"))))}function D(o){const i=Number(o);return Number.isFinite(i)?i:0}function K({value:o,onChange:i,placeholder:y}){return e.createElement("input",{className:"input",inputMode:"numeric",pattern:"[0-9]*",placeholder:y,style:{width:100},value:o,onChange:u=>i(u.target.value.replace(/[^\d.]/g,""))})}const fe=e.lazy(()=>ue(()=>import("./QuickViewModal-D5f2Mn55.js"),__vite__mapDeps([0,1,2,3,4]))),ye=[{key:"all",label:"All Collections"},{key:"affirmation",label:"Affirmation"},{key:"afrodisia",label:"Afrodisia"},{key:"pantheon",label:"Pantheon"},{key:"fall",label:"Fall"},{key:"winter",label:"Winter"}],X="https://afrodezea.com",Y=o=>o?o.split(",").map(i=>i.trim()).filter(Boolean):[],Z=o=>o&&o.length?o.join(","):"";function xe(){const o=ce(),i="Luxury Candles | Afrodezea",y="Explore premium candles with rich scent profiles. Filter by notes and intensity.",u=`${X}/products`,[a,b]=oe(),C=(a.get("collection")||"all").toLowerCase(),N=a.get("q")||"",M=Y(a.get("tags")).map(t=>t.toLowerCase()),k=a.get("min")?Number(a.get("min")):null,P=a.get("max")?Number(a.get("max")):null,L=a.get("order")||"new",_=a.get("page")?Math.max(1,Number(a.get("page"))):1,[w,l]=s.useState(!0),[x,$]=s.useState([]),[T,R]=s.useState(0),[c,q]=s.useState(C),[g,I]=s.useState(N),[h,F]=s.useState(M),[m,Q]=s.useState(k),[d,j]=s.useState(P),[p,z]=s.useState(L),[r,S]=s.useState(_),[ee,B]=s.useState(!1),[te,ne]=s.useState(null),H=24;s.useEffect(()=>{let t=!0;l(!0);const n=setTimeout(async()=>{try{const{rows:E,total:f}=await me({q:g,collection:c,tags:h,minPriceCents:typeof m=="number"?m:void 0,maxPriceCents:typeof d=="number"?d:void 0,order:p,page:r,pageSize:H});t&&($(E),R(f))}catch(E){console.error("[products] search failed",E),t&&($([]),R(0))}finally{t&&l(!1)}},220);return()=>{t=!1,clearTimeout(n)}},[g,c,h.join("|"),m,d,p,r]),s.useEffect(()=>{const t=setTimeout(()=>{const n=new URLSearchParams(a);c&&c!=="all"?n.set("collection",c):n.delete("collection"),g.trim()?n.set("q",g.trim()):n.delete("q"),h.length?n.set("tags",Z(h)):n.delete("tags"),m!=null?n.set("min",String(m)):n.delete("min"),d!=null?n.set("max",String(d)):n.delete("max"),p&&p!=="new"?n.set("order",p):n.delete("order"),r&&r!==1?n.set("page",String(r)):n.delete("page"),n.toString()!==a.toString()&&b(n,{replace:!1})},150);return()=>clearTimeout(t)},[c,g,h,m,d,p,r,a,b]),s.useEffect(()=>{const t=(a.get("collection")||"all").toLowerCase(),n=a.get("q")||"",E=Y(a.get("tags")).map(v=>v.toLowerCase()),f=a.get("min")?Number(a.get("min")):null,V=a.get("max")?Number(a.get("max")):null,G=a.get("order")||"new",W=a.get("page")?Math.max(1,Number(a.get("page"))):1;q(v=>v!==t?t:v),I(v=>v!==n?n:v),E.join("|")!==h.join("|")&&F(E),f!==m&&Q(f),V!==d&&j(V),G!==p&&z(G),W!==r&&S(W)},[a.toString()]);const A=s.useMemo(()=>{const t=new URLSearchParams;c&&c!=="all"&&t.set("collection",c),g.trim()&&t.set("q",g.trim()),h.length&&t.set("tags",Z(h)),m!=null&&t.set("min",String(m)),d!=null&&t.set("max",String(d)),p&&p!=="new"&&t.set("order",p),r&&r!==1&&t.set("page",String(r));const n=t.toString();return n?`?${n}`:""},[c,g,h,m,d,p,r]);s.useEffect(()=>{try{sessionStorage.setItem("afd:lastProductsSearch",A||"")}catch{}},[A]);const ae=t=>{const n=t.toLowerCase();F(E=>{const f=new Set(E);return f.has(n)?f.delete(n):f.add(n),r!==1&&S(1),Array.from(f)})},le=(t,n)=>{Q(t??null),j(n??null),r!==1&&S(1)},re=t=>{z(t),r!==1&&S(1)},U=t=>S(Math.max(1,t)),se=x,O=Math.max(1,Math.ceil(T/H));return e.createElement(e.Fragment,null,e.createElement(ie,null,e.createElement("title",null,i),e.createElement("meta",{name:"description",content:y}),e.createElement("link",{rel:"canonical",href:`${o}/products`}),e.createElement("meta",{property:"og:type",content:"website"}),e.createElement("meta",{property:"og:title",content:i}),e.createElement("meta",{property:"og:description",content:y}),e.createElement("meta",{property:"og:url",content:u}),e.createElement("meta",{name:"twitter:card",content:"summary_large_image"})),!w&&x?.length>0&&e.createElement("script",{type:"application/ld+json"},JSON.stringify({"@context":"https://schema.org","@type":"ItemList",itemListElement:x.map((t,n)=>({"@type":"ListItem",position:n+1,url:`${X}/p/${t.handle||t.slug}`,name:t.title}))})),e.createElement(e.Suspense,{fallback:null},e.createElement(fe,{open:ee,onClose:()=>B(!1),product:te})),e.createElement("div",{className:"container",style:{padding:24}},e.createElement("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:24,alignItems:"start"}},e.createElement("aside",{style:{position:"sticky",top:84}},e.createElement("div",{className:"surface",style:{padding:12}},e.createElement(pe,{tabs:ye,active:c,onChange:t=>{q(t),r!==1&&S(1)}})),e.createElement("div",{style:{height:12}}),e.createElement("div",{className:"surface",style:{padding:12}},e.createElement(ge,{query:g,onQueryChange:t=>{I(t),r!==1&&S(1)},selectedTags:h,onToggleTag:ae,minPrice:m!=null?Math.round(m/100):null,maxPrice:d!=null?Math.round(d/100):null,onPriceChange:(t,n)=>{const E=t==null?null:Math.round(Number(t)*100),f=n==null?null:Math.round(Number(n)*100);le(E,f)},order:p,onOrderChange:re}))),e.createElement("main",null,e.createElement("div",{style:{marginBottom:12,opacity:.85}},w?"Loading…":`${T} result${T===1?"":"s"}`,g?` for “${g}”`:"",c!=="all"?` in ${c}`:""),w?e.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:20}},Array.from({length:8}).map((t,n)=>e.createElement("div",{key:n,style:{height:320,borderRadius:16,background:"linear-gradient(90deg,#151515,#1a1a1a,#151515)",animation:"shimmer 1.2s linear infinite",backgroundSize:"300% 100%"}}))):e.createElement(e.Fragment,null,e.createElement(de,{products:se,fromSearch:A,onQuickView:t=>{ne(t),B(!0)}}),O>1&&e.createElement("div",{style:{display:"flex",gap:8,justifyContent:"center",marginTop:16}},e.createElement("button",{className:"btn",disabled:r<=1,onClick:()=>U(r-1)},"Prev"),e.createElement("span",{style:{alignSelf:"center"}},r," / ",O),e.createElement("button",{className:"btn",disabled:r>=O,onClick:()=>U(r+1)},"Next")))))))}export{xe as default};
