import{d as E,r as o,R as t,L as _,s as v}from"./index-D3n6H1Cv.js";import{P as N}from"./ProductsGrid-LUEFzvOo.js";import"./productsSupabase-Dmcm6j9L.js";function x(){const{ids:a=[],loading:u}=E(),[c,l]=o.useState([]),[g,d]=o.useState(!1);o.useEffect(()=>{let s=!0;async function e(r){const n=r==="slug"?"id, title, slug, image_url, price_cents":"id, title, handle, image_url, price_cents",{data:y,error:m}=await v.from("products").select(n).in("id",a);if(m)throw m;const w=new Map((y||[]).map(i=>[i.id,i]));return a.map(i=>w.get(i)).filter(Boolean).map(i=>({...i,handle:i.slug??i.handle??null}))}async function h(){if(!a||a.length===0){s&&l([]);return}d(!0);try{const r=await e("slug");s&&l(r)}catch(r){if(r?.code==="42703")try{const n=await e("handle");s&&l(n)}catch(n){console.error("[wishlist] load products failed (handle retry):",n),s&&l([])}else console.error("[wishlist] load products failed:",r),s&&l([])}finally{s&&d(!1)}}return h(),()=>{s=!1}},[a]);const p=o.useMemo(()=>(Array.isArray(c)?c:[]).map(e=>({id:e.id,title:e.title,handle:e.handle,image_url:e.image_url||null,price_cents:e.price_cents??0,priceRange:{minVariantPrice:{amount:(e.price_cents??0)/100,currencyCode:"USD"}},images:e.image_url?{nodes:[{url:e.image_url}]}:{nodes:[]}})),[c]),f=!a||a.length===0;return t.createElement("div",{className:"container",style:{padding:24}},t.createElement("h1",{className:"display",style:{marginBottom:12}},"Your Wishlist"),f?t.createElement("div",{className:"surface",style:{padding:16}},t.createElement("p",{className:"lead",style:{marginTop:0}},"No items yet."),t.createElement(_,{className:"btn btn--gold",to:"/products"},"Browse products")):t.createElement(t.Fragment,null,t.createElement("div",{style:{marginBottom:12,display:"flex",gap:8,alignItems:"center"}},t.createElement("span",{style:{opacity:.85}},a.length," saved ",a.length===1?"item":"items",u||g?" • loading…":"")),t.createElement(N,{products:p,onQuickView:()=>{}}),t.createElement("div",{style:{marginTop:16,opacity:.8}},"Tip: open a product and tap ♥ to remove it from your wishlist.")))}export{x as default};
